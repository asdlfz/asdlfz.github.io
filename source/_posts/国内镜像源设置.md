---
title: 国内镜像源设置
top: true
cover: false
toc: true
mathjax: true
date: 2022-04-18 14:26:20
password:
summary: 搭建博客记录笔记
tags:
- Github
- Hexo
- 博客搭建
categories:
- Blog
---
# 说明
Linux软件源、开发语言依赖源、容器镜像源基本都在国外，因此国内访问非常慢
国内各大云厂商基本都做了对应的镜像源，果断用起来！
如无特殊情况，都使用清华的源https://opentuna.cn作为展示

# 更新
 npm 淘宝镜像切换域名为 https://npmmirror.com
 老 http://npm.taobao.org 和 http://registry.npm.taobao.org 域名将于2022年05月31日零时起停止服务。

# Linux系统
>软件源基本是通用的
## CentOS 6/7/8系统源配置
```
export REPO_MIRROR="https://opentuna.cn/centos"
sed -e "s!#baseurl!baseurl!g" \
-e "s!mirrorlist!#mirrorlist!g" \
-e "s!http://mirror.centos.org!${REPO_MIRROR}!g" \
-i /etc/yum.repos.d/CentOS-Base.repo
```
## EPEL源配置
```
export REPO_MIRROR="https://opentuna.cn/epel"
sed -e "s!^metalink=!#metalink=!g" \
-e "s!^#baseurl=!baseurl=!g" \
-e "s!https://download.fedoraproject.org/pub/epel!${REPO_MIRROR}!g" \
-i /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel-testing.repo
```
## Debian9/10/11配置说明
```
export REPO_MIRROR="https://opentuna.cn"
sed -e "s@http://deb.debian.org@${REPO_MIRROR}@g" \
-e "s@http://security.debian.org@${REPO_MIRROR}@g" \
-e "s@^deb-src@# deb-src@g" \
-i /etc/apt/sources.list
```
## Ubuntu16.04/18.04/20.04配置说明
```
export REPO_MIRROR="https://opentuna.cn"
sed -e "s@http://.*archive.ubuntu.com@${REPO_MIRROR}@g" \
-e "s@http://.*security.ubuntu.com@${REPO_MIRROR}@g" \
-e "s@^deb-src@# deb-src@g" \
-i /etc/apt/sources.list
```
## 开发语言
### Python
#### pip [![PyPI - Python Version](https://img.shields.io/pypi/v/pip.svg)](https://pypi.org/project/pip/)
##### 临时使用
```
pip install -i https://opentuna.cn/pypi/web/simple some-package
```
##### 配置方法
直接写配置文件
```
mkdir -p ~/.pip
cat > ~/.pip/pip.conf <<EOF
[global]
index-url = https://opentuna.cn/pypi/web/simple
trusted-host = opentuna.cn
timeout = 120
[install]
trusted-host = opentuna.cn
EOF
```
##### 命令配置(这里针对较新版本的pip)
###### 清华大学
```
pip config set global.index-url https://opentuna.cn/pypi/web/simple
pip config set global.trusted-host opentuna.cn
pip config set global.timeout 120
pip config set install.trusted-host opentuna.cn
```
###### 阿里云公网
```
pip config set global.index-url https://mirrors.aliyun.com/pypi/simple/
pip config set global.trusted-host mirrors.aliyun.com
pip config set global.timeout 120
pip config set install.trusted-host mirrors.aliyun.com
```
###### 阿里云内网
```
pip config set global.index-url http://mirrors.cloud.aliyuncs.com/pypi/simple/
pip config set global.trusted-host mirrors.cloud.aliyuncs.com
pip config set global.timeout 120
pip config set install.trusted-host mirrors.cloud.aliyuncs.com
```
#### conda ![Conda](https://img.shields.io/conda/v/conda-forge/python)
```
Linux系统保存到~/.condarc
MacOS系统保存到~/.condarc
Windows系统保存到%HOMEPATH%/.condarc

channels:
- defaults
show_channel_urls: true
channel_alias: https://mirrors.tuna.tsinghua.edu.cn/anaconda
default_channels:
- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free
- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r
- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/pro
- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2

custom_channels:
conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
```
### NPM [![npm version](https://img.shields.io/npm/v/npm.svg)](https://npm.im/npm)
#### 淘宝
- \
开源镜像
- https://npmmirror.com/mirrors
Node.js 镜像
-  https://npmmirror.com/mirrors/node
alinode 镜像
- https://npmmirror.com/mirrors/alinode
phantomjs 镜像
- https://npmmirror.com/mirrors/phantomjs
ChromeDriver 镜像
- https://npmmirror.com/mirrors/chromedriver
OperaDriver 镜像
- https://npmmirror.com/mirrors/operadriver
Selenium 镜像
- https://npmmirror.com/mirrors/selenium
Node.js 文档镜像
- https://npmmirror.com/mirrors/node/latest/docs/api/index.html
NPM 镜像
- https://npmmirror.com/mirrors/npm/
electron 镜像
- https://npmmirror.com/mirrors/electron/
node-inspector 镜像
- https://npmmirror.com/mirrors/node-inspector/

#### 华为云
- \
node-registry的镜像地址
- https://mirrors.huaweicloud.com/repository/npm/
nodejs工具的镜像地址
- https://mirrors.huaweicloud.com/nodejs
Node-Sass的镜像地址
- https://mirrors.huaweicloud.com/node-sass
浏览器引擎驱动镜像地址
- https://mirrors.huaweicloud.com/phantomjs
- https://mirrors.huaweicloud.com/chromedriver
- https://mirrors.huaweicloud.com/operadriver
Electron和Python的镜像地址
- https://mirrors.huaweicloud.com/electron/
- https://mirrors.huaweicloud.com/python

#### 单次使用
```
npm install --registry=https://registry.npmmirror.com PACKAGE
```
#### 配置方法
这里以华为云为例，演示一下
直接写配置文件

Linux系统保存到\~/.npmrc
MacOS系统保存到~/.npmrc
Windows系统保存到%HOMEPATH%/.npmrc
```
registry=https://repo.huaweicloud.com/repository/npm/
disturl=https://repo.huaweicloud.com/nodejs
sass_binary_site=https://repo.huaweicloud.com/node-sass
phantomjs_cdnurl=https://repo.huaweicloud.com/phantomjs
chromedriver_cdnurl=https://repo.huaweicloud.com/chromedriver
operadriver_cdnurl=https://repo.huaweicloud.com/operadriver
electron_mirror=https://repo.huaweicloud.com/electron/
python_mirror=https://repo.huaweicloud.com/python
```
#### 命令配置
设置node-registry的镜像地址
```
npm config set registry https://repo.huaweicloud.com/repository/npm/
```
设置nodejs工具的镜像地址
```
npm config set disturl https://repo.huaweicloud.com/nodejs
```
设置Node-Sass的镜像地址
```
npm config set sass_binary_site https://repo.huaweicloud.com/node-sass
```
设置浏览器引擎驱动镜像地址
```
npm config set phantomjs_cdnurl https://repo.huaweicloud.com/phantomjs
npm config set chromedriver_cdnurl https://repo.huaweicloud.com/chromedriver
npm config set operadriver_cdnurl https://repo.huaweicloud.com/operadriver
```
设置Electron和Python的镜像地址
```
npm config set electron_mirror https://repo.huaweicloud.com/electron/
npm config set python_mirror https://repo.huaweicloud.com/python
```
#### 清理npm缓存
```
npm cache clean -f
```
### Golang  ![GitHub go.mod Go version (branch & subdirectory of monorepo)](https://img.shields.io/github/go-mod/go-version/golang/go/master?color=ff69b4&filename=src%2Fgo.mod&style=plastic)
要求 **Golang 1.11+**
``go env``*会读取系统环境变量，所以配置起来很简单*
***开启Go Module***
**Golang 1.13+** *里面的GOPROXY变成了数组，可以定义多个Proxy*

#### 阿里云
- https://mirrors.aliyun.com/goproxy/
- https://mirrors.cloud.aliyuncs.com/goproxy/

#### 华为云
-	https://mirrors.huaweicloud.com/goproxy

#### 腾讯云
-	https://mirrors.cloud.tencent.com/go/

#### 七牛云
- https://goproxy.cn

#### 针对Golang 1.11
```
export GO111MODULE=on
export GOPROXY='https://goproxy.cn'
```
#### 针对Golang 1.13+
```
export GO111MODULE=on
export GOPROXY='https://goproxy.cn,https://mirrors.aliyun.com/goproxy,direct'
```
#### 这里把git.example.com设置为私有的git服务器
```
export GOPRIVATE="git.example.com"
export GOSUMDB="sum.golang.google.cn"
```
Maven
阿里云
阿里云代理了Maven的公共仓库，这里是说明文档

腾讯云
1	http://mirrors.cloud.tencent.com/nexus/repository/maven-public/
华为云
1	https://mirrors.huaweicloud.com/repository/maven/
### Maven配置
打开 Maven 的配置文件(windows机器一般在maven安装目录的conf/settings.xml)，在<mirrors></mirrors>标签中添加 mirror 子节点:
```
<mirrors>
<mirror>
<id>aliyunmaven</id>
<mirrorOf>*</mirrorOf>
<url>https://maven.aliyun.com/repository/public</url>
</mirror>
```
```
<mirror>
<id>huaweicloud</id>
<mirrorOf>*</mirrorOf>
<url>https://mirrors.huaweicloud.com/repository/maven/</url>
</mirror>
```
```
<mirror>
<id>nexus-tencentyun</id>
<mirrorOf>*</mirrorOf>
<url>http://mirrors.cloud.tencent.com/nexus/repository/maven-public/</url>
</mirror>
</mirrors>
```
如果想使用其它代理仓库,可在<repository></repository>节点中加入对应的仓库使用地址。以使用spring代理仓为例：
```
<repository>
<id>spring</id>
<url>https://maven.aliyun.com/repository/spring</url>
<releases>
<enabled>true</enabled>
</releases>
<snapshots>
<enabled>true</enabled>
</snapshots>
</repository>
```
### Gradle配置
在 build.gradle 文件中加入以下代码:
```
allprojects {
repositories {
maven { url 'https://maven.aliyun.com/repository/public/' }
mavenLocal()
mavenCentral()
}
}
```
如果想使用 maven.aliyun.com 提供的其它代理仓，以使用 spring 仓为例，代码如下:
```
allprojects {
repositories {
maven { url 'https://maven.aliyun.com/repository/public/' }
maven { url 'https://maven.aliyun.com/repository/spring/'}
mavenLocal()
mavenCentral()
}
}
```
### 容器 DockerHub
说明 docker 配置文件路径 ``/etc/docker/daemon.json`` 多个mirrors地址可以合并
**配置方法**
```
{
"registry-mirrors": [
"https://pqbap4ya.mirror.aliyuncs.com",
"https://mirror.ccs.tencentyun.com",
"https://05f073ad3c0010ea0f4bc00b7105ec20.mirror.swr.myhuaweicloud.com",
"https://hub-mirror.c.163.com",
"https://mirror.baidubce.com"
]
}
```
### Kubernetes软件源
说明
**这里用阿里云的源**
#### CentOS 7/8
```
cat > /etc/yum.repos.d/kubernetes.repo <<EOF
[kubernetes]
name=Kubernetes
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
EOF
```
#### Debian 9/10
```
curl -s https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add -
cat <<EOF >/etc/apt/sources.list.d/kubernetes.list
deb https://mirrors.aliyun.com/kubernetes/apt kubernetes-stretch main
EOF
```
#### Ubuntu 16.04/18.04/20.04
```
curl -s https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add -
cat <<EOF >/etc/apt/sources.list.d/kubernetes.list
deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main
EOF
```
**k8s.gcr.io**
国内齐全好用版本新的源推荐【张馆长】维护的，项目地址

- **registry.aliyuncs.com/k8sxio**
- **quay.io**

国内没有公有云厂商对外开放服务，只有网友自己维护的一些源

- **quay.azk8s.cn**（于 2020年4月2日限制了对 Azure China 之外的 IP访问）
- **quay.mirrors.ustc.edu.cn** (从中科大校外对 Quay Container Registry 的镜像缓存的访问会被 302 重定向至源站)
- **quay-mirror.qiniu.com** (已停止公网DNS解析)

网友维护 张馆长
- https://github.com/zhangguanzhang/google_containers

本仓库只同步 **k8s.gcr.io ==> registry.aliyuncs.com/k8sxio**

特性
不依赖 Docker 运行
同步期间不占用本地磁盘空间(直接通过标准库转发镜像)
可控的并发同步(优雅关闭/可调节并发数量)
核心拷贝方法引用的``containers/image``，部分代码借鉴了``mritd ``
利用 boltdb 存储每个镜像 manifest 信息的 crc32 校验值，通过比对判断是否需要同步，而不是每次请求目标仓库
把 boltdb 文件放 docker 镜像里存在 dockerhub 上，多次运行 ``action`` 来同步
漠然 **https://github.com/mritd/imgsync**

特性
不依赖 Docker 运行
基于 Manifests 同步
支持 Fat Manifests 镜像同步
Manifests 文件本地 Cache，按需同步
同步期间不占用本地磁盘空间(直接通过标准库转发镜像)
可控的并发同步(优雅关闭/可调节并发数量)
按批次同步，支持同步指定区间段镜像
支持多仓库同步(后续仓库增加请提交 issue)
支持生成同步报告，同步报告推送 Telegram
***Registry	Address	Docker Hub***
**Flannel**	``quay.io/coreos/flannel	gcrxio/quay.io_coreos_flannel``  \
**kubeadm**	``k8s.gcr.io	gcrxio/k8s.gcr.io_*``  \
**Helm**	``gcr.io/kubernetes-helm	gcrxio/gcr.io_kubernetes-helm_*``  \
**Istio**	``gcr.io/istio-release	gcrxio/gcr.io_istio-release_*``  \
**Linkerd**	``gcr.io/linkerd-io	gcrxio/gcr.io_linkerd-io_*``  \
**Spinnaker**	``gcr.io/spinnaker-marketplace	gcrxio/gcr.io_spinnaker-marketplace_*``  \
**Distroless**	``gcr.io/distroless	gcrxio/gcr.io_distroless_*``  \
**Samples**	``gcr.io/google-samples	gcrxio/gcr.io_google-samples_*``  \
**KNative**	``gcr.io/knative-releases	gcrxio/gcr.io_knative-releases_*``  \
本文作者： 乱愣黎
本文链接： https://luanlengli.github.io/2020/01/17/国内镜像源设置.html
版权声明： 本博客所有文章除特别声明外，均采用 CC BY-NC-SA 3.0 许可协议。转载请注明出处！
